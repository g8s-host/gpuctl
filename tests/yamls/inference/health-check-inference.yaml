kind: inference
version: v0.1

# 任务标识
job:
  name: health-check-inference
  priority: "medium"
  description: "带健康检查的推理任务，用于高可用服务场景"

# 环境与镜像
environment:
  image: tiangolo/uvicorn-gunicorn-fastapi:latest
  command: ["uvicorn", "app:app", "--host", "0.0.0.0", "--port", "8000"]
  env:
    - name: NVIDIA_FLASH_ATTENTION
      value: "1"

# 服务配置
service:
  replicas: 3
  port: 8000
  healthCheck: /api/health
  timeout: 30s

# 资源规格
resources:
  pool: training-pool
  gpu: 1
  gpuType: a10-24g
  cpu: 6
  memory: 24Gi
  gpuShare: 2Gi

storage:
  workdirs:
    - path: /app
    - path: /data
    - path: /logs