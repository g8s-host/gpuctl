kind: training
version: v0.1

# 任务标识与描述
job:
  name: test-training-job
  priority: "high"
  description: "测试训练任务"

# 环境与镜像
environment:
  image: hiyouga/llamafactory:0.9.4
  command: ["llama-factory-cli", "train", "--stage", "sft", "--model_name_or_path", "/models/qwen2-7b", "--dataset", "alpaca-qwen", "--dataset_dir", "/datasets", "--output_dir", "/output/qwen2-sft"]
  env:
    - name: NVIDIA_FLASH_ATTENTION
      value: "1"
    - name: LLAMA_FACTORY_CACHE
      value: "/cache/llama-factory"

# 资源需求声明
resources:
  pool: training-pool
  gpu: 2
  gpuType: a10-24g
  cpu: 8
  memory: 32Gi
  gpuShare: 2Gi

# 数据与模型配置
storage:
  workdirs:
    - path: /datasets/alpaca-qwen.json
    - path: /models/qwen2-7b    
    - path: /output/qwen2-sft